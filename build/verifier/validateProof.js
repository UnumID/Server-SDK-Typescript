"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.validateProof = void 0;
var library_issuer_verifier_utility_1 = require("@unumid/library-issuer-verifier-utility");
/**
 * Helper to validate a proof has the required attributes.
 * @param proof JSONObj
 */
exports.validateProof = function (proof) {
    var created = proof.created, signatureValue = proof.signatureValue, type = proof.type, verificationMethod = proof.verificationMethod, proofPurpose = proof.proofPurpose;
    if (!created) {
        throw new library_issuer_verifier_utility_1.CustError(400, 'Invalid Presentation: proof.created is required.');
    }
    if (!signatureValue) {
        throw new library_issuer_verifier_utility_1.CustError(400, 'Invalid Presentation: proof.signatureValue is required.');
    }
    if (!type) {
        throw new library_issuer_verifier_utility_1.CustError(400, 'Invalid Presentation: proof.type is required.');
    }
    if (!verificationMethod) {
        throw new library_issuer_verifier_utility_1.CustError(400, 'Invalid Presentation: proof.verificationMethod is required.');
    }
    if (!proofPurpose) {
        throw new library_issuer_verifier_utility_1.CustError(400, 'Invalid Presentation: proof.proofPurpose is required.');
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmFsaWRhdGVQcm9vZi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy92ZXJpZmllci92YWxpZGF0ZVByb29mLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLDJGQUE2RTtBQUU3RTs7O0dBR0c7QUFDVSxRQUFBLGFBQWEsR0FBRyxVQUFDLEtBQWM7SUFFeEMsSUFBQSxPQUFPLEdBS0wsS0FBSyxRQUxBLEVBQ1AsY0FBYyxHQUlaLEtBQUssZUFKTyxFQUNkLElBQUksR0FHRixLQUFLLEtBSEgsRUFDSixrQkFBa0IsR0FFaEIsS0FBSyxtQkFGVyxFQUNsQixZQUFZLEdBQ1YsS0FBSyxhQURLLENBQ0o7SUFFVixJQUFJLENBQUMsT0FBTyxFQUFFO1FBQ1osTUFBTSxJQUFJLDJDQUFTLENBQUMsR0FBRyxFQUFFLGtEQUFrRCxDQUFDLENBQUM7S0FDOUU7SUFFRCxJQUFJLENBQUMsY0FBYyxFQUFFO1FBQ25CLE1BQU0sSUFBSSwyQ0FBUyxDQUFDLEdBQUcsRUFBRSx5REFBeUQsQ0FBQyxDQUFDO0tBQ3JGO0lBRUQsSUFBSSxDQUFDLElBQUksRUFBRTtRQUNULE1BQU0sSUFBSSwyQ0FBUyxDQUFDLEdBQUcsRUFBRSwrQ0FBK0MsQ0FBQyxDQUFDO0tBQzNFO0lBRUQsSUFBSSxDQUFDLGtCQUFrQixFQUFFO1FBQ3ZCLE1BQU0sSUFBSSwyQ0FBUyxDQUFDLEdBQUcsRUFBRSw2REFBNkQsQ0FBQyxDQUFDO0tBQ3pGO0lBRUQsSUFBSSxDQUFDLFlBQVksRUFBRTtRQUNqQixNQUFNLElBQUksMkNBQVMsQ0FBQyxHQUFHLEVBQUUsdURBQXVELENBQUMsQ0FBQztLQUNuRjtBQUNILENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEpTT05PYmosIEN1c3RFcnJvciB9IGZyb20gJ0B1bnVtaWQvbGlicmFyeS1pc3N1ZXItdmVyaWZpZXItdXRpbGl0eSc7XG5cbi8qKlxuICogSGVscGVyIHRvIHZhbGlkYXRlIGEgcHJvb2YgaGFzIHRoZSByZXF1aXJlZCBhdHRyaWJ1dGVzLlxuICogQHBhcmFtIHByb29mIEpTT05PYmpcbiAqL1xuZXhwb3J0IGNvbnN0IHZhbGlkYXRlUHJvb2YgPSAocHJvb2Y6IEpTT05PYmopOiB2b2lkID0+IHtcbiAgY29uc3Qge1xuICAgIGNyZWF0ZWQsXG4gICAgc2lnbmF0dXJlVmFsdWUsXG4gICAgdHlwZSxcbiAgICB2ZXJpZmljYXRpb25NZXRob2QsXG4gICAgcHJvb2ZQdXJwb3NlXG4gIH0gPSBwcm9vZjtcblxuICBpZiAoIWNyZWF0ZWQpIHtcbiAgICB0aHJvdyBuZXcgQ3VzdEVycm9yKDQwMCwgJ0ludmFsaWQgUHJlc2VudGF0aW9uOiBwcm9vZi5jcmVhdGVkIGlzIHJlcXVpcmVkLicpO1xuICB9XG5cbiAgaWYgKCFzaWduYXR1cmVWYWx1ZSkge1xuICAgIHRocm93IG5ldyBDdXN0RXJyb3IoNDAwLCAnSW52YWxpZCBQcmVzZW50YXRpb246IHByb29mLnNpZ25hdHVyZVZhbHVlIGlzIHJlcXVpcmVkLicpO1xuICB9XG5cbiAgaWYgKCF0eXBlKSB7XG4gICAgdGhyb3cgbmV3IEN1c3RFcnJvcig0MDAsICdJbnZhbGlkIFByZXNlbnRhdGlvbjogcHJvb2YudHlwZSBpcyByZXF1aXJlZC4nKTtcbiAgfVxuXG4gIGlmICghdmVyaWZpY2F0aW9uTWV0aG9kKSB7XG4gICAgdGhyb3cgbmV3IEN1c3RFcnJvcig0MDAsICdJbnZhbGlkIFByZXNlbnRhdGlvbjogcHJvb2YudmVyaWZpY2F0aW9uTWV0aG9kIGlzIHJlcXVpcmVkLicpO1xuICB9XG5cbiAgaWYgKCFwcm9vZlB1cnBvc2UpIHtcbiAgICB0aHJvdyBuZXcgQ3VzdEVycm9yKDQwMCwgJ0ludmFsaWQgUHJlc2VudGF0aW9uOiBwcm9vZi5wcm9vZlB1cnBvc2UgaXMgcmVxdWlyZWQuJyk7XG4gIH1cbn07XG4iXX0=